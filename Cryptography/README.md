Cryptography task!


At first, we are given a login page which asks for username and password, along with a forget password button. 
The problem statement hints to the fact that the backup password is hidden someplace easily accesbbile. Going to the source code of the website, we see a ciphertext comment!

GUR HFREANZR VF: UHRUHRUHR

GUR ONPXHC CNFFJBEQ VF: V NZ GUR ORFG QBTR

It seems to be a simple Caesar cipher, and python program which bruteforces the number of shifts reveals to us that it is indeed a Caesar cipher with a shift of 13! On decryption, we get :

THE USERNAME IS: HUEHUEHUE

   THE BACKUP PASSWORD IS: I AM THE BEST DOGE

On entering these credentials, we enter a page with an image of sad doge. There is also some plain white text, which I initially thought was a hint, but turned out to be a false flag. Doge asks us to take his advice more seriously. Reading the problem statement, more carefully, the hacker had stated that  "You must contact me if you wish to regain access to your account", which suggests that one must send an email to the account	wec.system.recs2022@gmail.com, which the hacker controls.

Upon sending an email to wec.system.recs2022@gmail.com, we indeed get back an answer, given below:

\x50\x4C\x41\x59\x20\x57\x49\x54\x48\x20\x54\x48\x45\x20\x43\x49\x50\x48\x45\x52\x54\x45\x58\x54\x20\x55\x53\x49\x4E\x47\x20\x57\x48\x41\x54\x20\x57\x41\x53\x20\x4E\x41\x4D\x45\x44\x20\x41\x46\x54\x45\x52\x20\x41\x20\x4C\x4F\x52\x44\x20\x48\x4F\x53\x49\x44\x55\x4D\x59\x4F\x50\x49\x41\x4D\x49\x43\x5A\x41\x5A\x42\x55\x44\x54\x50\x43\x49\x4C\x4E\x56\x4D\x50\x5A\x42\x45\x42\x5A\x42\x47\x54\x45\x42\x4D\x4C\x46\x43\x43\x41\x51\x49\x4D\x47\x52\x4C\x44\x59\x45\x58\x49\x50\x51\x4D\x43\x4B\x4E\x5A\x43\x54\x52\x5A\x4C\x58\x44\x46\x43\x4C\x43\x54\x55\x51\x49\x4F\x41\x45\x4F\x59\x55\x42\x4F\x46\x48\x4B\x50\x54\x51\x4E\x44\x59\x5A\x42\x51\x41\x44\x55\x47\x4F\x43\x55\x41\x5A\x42\x55\x44\x49\x44\x56\x41\x5A\x42\x55\x44\x59\x47\x4F\x44\x55\x4B\x43\x58\x54\x55\x51\x49\x4F\x41\x45\x4F\x59\x53\x49\x44\x5A\x46\x43\x49\x59\x4E\x54\x49\x4B\x49\x51\x4C\x4D\x42\x44\x43\x55\x53\x49\x43\x4B\x42\x44\x50\x4B\x51\x42\x4E\x5A\x4C\x45\x55\x42\x4F\x53\x4F\x56\x50\x41\x49\x51\x42\x4C\x43\x55\x51\x43\x4B\x42\x53\x49\x42\x55\x43\x55\x48\x47\x44\x4D\x5A\x59\x58\x44\x41\x46\x4F\x57\x58\x54\x41\x46\x47\x4C\x55\x57\x41\x59\x51\x44\x4E\x50\x54\x4E\x49\x4E\x56\x49\x41\x48\x46\x4C\x55\x57\x44\x47\x4D\x54\x58\x55\x4C\x56\x54\x4E\x57\x50\x51\x5A\x57\x43\x4B\x47\x51\x48\x4F\x49\x49\x55\x4B\x59\x4C\x46\x4E\x49\x4B\x47\x54\x44\x44\x59\x52\x4B\x51\x42\x47\x41\x4F\x54\x51\x4B\x4E\x50\x48\x59\x48\x54\x48\x47\x58\x54\x41\x46\x47\x4C\x44\x4D\x5A\x59\x58\x44\x41\x46\x4F\x57\x42\x53\x52\x48\x52\x48\x47\x51\x45\x51\x41\x46\x46\x4C\x57\x44\x57\x56\x52\x57\x45\x4B\x46\x41\x48\x59\x47\x54\x45\x4B\x49\x4D\x57\x49\x49\x56\x59\x44\x55\x57\x41\x5A\x56\x4B\x41\x51\x52\x48\x47\x41\x42\x51\x56\x48\x44\x54\x5A\x59\x56\x49\x46\x47\x58\x55\x48\x56\x4B\x56\x50\x59\x4E\x52\x48\x47\x58\x51\x48\x47\x44\x4C\x5A\x57\x56\x4B\x4C\x56\x45\x57\x55\x57\x47\x41\x4F\x59\x5A\x59\x56\x49\x46\x47\x59\x45\x59\x51\x57\x49\x59\x51\x47\x4F\x49\x47\x4E\x49\x4B\x47\x51\x58\x50\x54\x51\x4B\x5A\x59\x58\x54\x48\x47\x41\x48\x49\x58\x53\x54\x47\x51\x4F\x41\x59\x51\x54\x50\x45\x4B\x4B\x56\x4C\x46\x4E\x54\x48\x51\x48\x47\x51\x5A\x43\x56\x46\x4C\x57\x44\x57\x56\x52\x57\x45\x4B\x49\x4D\x57\x49

Immediately one can recognise that it is a bunch of hex. Now we have to convert the hex into alphabets or numbers, since this hex text is of not much use.

Upon converting from hex to alphabets, we obtain the following string:

PLAYLAY AY WY WI WITWITHITH TH TH TH THETHE HE CE CI CIPCIPHIPHEPHERHERTERTERTEXTEXTEXT XT UT US USIUSINSINGING NG WG WH WHAWHATHAT AT WT WA WASWAS AS NS NA NAMNAMEAMEDMED ED AD AF AFTAFTEFTERTER ER AR A  A LA LO LORLORDORD RD HD HO HOSHOSIOSIDSIDUIDUMDUMYUMYOMYOPYOPIOPIAPIAMIAMIAMICMICZICZACZAZZAZBAZBUZBUDBUDTUDTPDTPCTPCIPCILCILNILNVLNVMNVMPVMPZMPZBPZBEZBEBBEBZEBZBBZBGZBGTBGTEGTEBTEBMEBMLBMLFMLFCLFCCFCCACCAQCAQIAQIMQIMGIMGRMGRLGRLDRLDYLDYEDYEXYEXIEXIPXIPQIPQMPQMCQMCKMCKNCKNZKNZCNZCTZCTRCTRZTRZLRZLXZLXDLXDFXDFCDFCLFCLCCLCTLCTUCTUQTUQIUQIOQIOAIOAEOAEOAEOYEOYUOYUBYUBOUBOFBOFHOFHKFHKPHKPTKPTQPTQNTQNDQNDYNDYZDYZBYZBQZBQABQADQADUADUGDUGOUGOCGOCUOCUACUAZUAZBAZBUZBUDBUDIUDIDDIDVIDVADVAZVAZBAZBUZBUDBUDYUDYGDYGOYGODGODUODUKDUKCUKCXKCXTCXTUXTUQTUQIUQIOQIOAIOAEOAEOAEOYEOYSOYSIYSIDSIDZIDZFDZFCZFCIFCIYCIYNIYNTYNTINTIKTIKIIKIQKIQLIQLMQLMBLMBDMBDCBDCUDCUSCUSIUSICSICKICKBCKBDKBDPBDPKDPKQPKQBKQBNQBNZBNZLNZLEZLEULEUBEUBOUBOSBOSOOSOVSOVPOVPAVPAIPAIQAIQBIQBLQBLCBLCULCUQCUQCUQCKQCKBCKBSKBSIBSIBSIBUIBUCBUCUUCUHCUHGUHGDHGDMGDMZDMZYMZYXZYXDYXDAXDAFDAFOAFOWFOWXOWXTWXTAXTAFTAFGAFGLFGLUGLUWLUWAUWAYWAYQAYQDYQDNQDNPDNPTNPTNPTNITNINNINVINVINVIAVIAHIAHFAHFLHFLUFLUWLUWDUWDGWDGMDGMTGMTXMTXUTXULXULVULVTLVTNVTNWTNWPNWPQWPQZPQZWQZWCZWCKWCKGCKGQKGQHGQHOQHOIHOIIOIIUIIUKIUKYUKYLKYLFYLFNLFNIFNIKNIKGIKGTKGTDGTDDTDDYDDYRDYRKYRKQRKQBKQBGQBGABGAOGAOTAOTQOTQKTQKNQKNPKNPHNPHYPHYHHYHTYHTHHTHGTHGXHGXTGXTAXTAFTAFGAFGLFGLDGLDMLDMZDMZYMZYXZYXDYXDAXDAFDAFOAFOWFOWBOWBSWBSRBSRHSRHRRHRHHRHGRHGQHGQEGQEQQEQAEQAFQAFFAFFLFFLWFLWDLWDWWDWVDWVRWVRWVRWERWEKWEKFEKFAKFAHFAHYAHYGHYGTYGTEGTEKTEKIEKIMKIMWIMWIMWIIWIIVIIVYIVYDVYDUYDUWDUWAUWAZWAZVAZVKZVKAVKAQKAQRAQRHQRHGRHGAHGABGABQABQVBQVHQVHDVHDTHDTZDTZYTZYVZYVIYVIFVIFGIFGXFGXUGXUHXUHVUHVKHVKVVKVPKVPYVPYNPYNRYNRHNRHGRHGXHGXQGXQHXQHGQHGDHGDLGDLZDLZWLZWVZWVKWVKLVKLVKLVELVEWVEWUEWUWWUWGUWGAWGAOGAOYAOYZOYZYYZYVZYVIYVIFVIFGIFGYFGYEGYEYYEYQEYQWYQWIQWIYWIYQIYQGYQGOQGOIGOIGOIGNIGNIGNIKNIKGIKGQKGQXGQXPQXPTXPTQPTQKTQKZQKZYKZYXZYXTYXTHXTHGTHGAHGAHGAHIAHIXHIXSIXSTXSTGSTGQTGQOGQOAQOAYOAYQAYQTYQTPQTPETPEKPEKKEKKVKKVLKVLFVLFNLFNTFNTHNTHQTHQHHQHGQHGQHGQZGQZCQZCVZCVFCVFLVFLWFLWDLWDWWDWVDWVRWVRWVRWERWEKWEKIEKIMKIMW

The way the string itself is written is a hint. The readable words seem to be formed of the first three characters, and an then the following 4 characters till the end of the word. The words are then differentiated by the last 2 letters of the previous word, the last and first letters of the previous and upcoming word, and the first two letters of the upcoming word. On observing the ciphertext, it looks like it follows the 3 letters,4 consecutive letters policy. We can write a simple program to select letters such that they do not repeat (due to consecutiveness) and obtain the original string, given below:

HOSIDUMYOPIAMICZAZBUDTPCILNVMPZBEBZBGTEBMLFCCAQIMGRLDYEXIPQMCKNZCTRZLXDFCLCTUQIOAEOYUBOFHKPTQNDYZBQADUGOCUAZBUDIDVAZBUDYGODUKCXTUQIOAEOYSIDZFCIYNTIKIQLMBDCUSICKBDPKQBNZLEUBOSOVPAIQBLCUQCKBSIBUCUHGDMZYXDAFOWXTAFGLUWAYQDNPTNINVIAHFLUWDGMTXULVTNWPQZWCKGQHOIIUKYLFNIKGTDDYRKQBGAOTQKNPHYHTHGXTAFGLDMZYXDAFOWBSRHRHGQEQAFFLWDWVRWEKFAHYGTEKIMWIIVYDUWAZVKAQRHGABQVHDTZYVIFGXUHVKVPYNRHGXQHGDLZWVKLVEWUWGAOYZYVIFGYEYQWIYQGOIGNIKGQXPTQKZYXTHGAHIXSTGQOAYQTPEKKVLFNTHQHGQZCVFLWDWVRWEKIMW

The text at the beginning asked us to play with the cipher using what was named after a Lord. It can only be the Playfair cipher. Using the standard Playfair cipher for decryption(which omits the letter J), we get a readable text!

INTHETOWNOFDOGEXEVERYONEFOLXLOWEDAWEIRDALPHABETFGBQMYTCZKORLEHPXDSUWNVAIANDSTUDIEDITRELIGIOUSLYTWELVETIMESEVERYDAYEVERYTIMETHEYSTUDIEDITTHEYHADTOSHIFTPLACESTHEHACKERAPXPARENTLYLEFTAMESSAGETHERESGFBOYXYCVAMYYSVAFMRZDVTAMOSOHOYFCFAFRZBIORZSFQSOZMUVXBIFSFIDKTIZFAOHIFOYYTUGRAFBIOUFMOIXISGFYSVAFMBOYXYCVAMYCRSGSGFRAUVAAFYBVZMRZEAVIXIRZEGOYGFYTYRZEVZFVLSGFBARXFYOYXYFKFZSFXFZOZMSGFVSGFAOYVZFFQBZRZFBITYXYFKFZDVTYGVTIMHFOHIFSVOUUFYXYSGFCFHYRSFRLDVTUOZEFZFAOSFSGFUVAXAFYBVZMRZEGOVW

The readable part says that in the town of Doge, they studied their alphabet 12 times a day, indicating that 12 is some sort of key/shift.The strange alphabet of the Doges is also given to be "FGBQMYTCZKORLEHPXDSUWNVAI" and surprisingly, it contains 25 characters and does not have the letter J! Passing the ciphertext through a simple shift cipher(Caesar) and using the weird alphabet instead of the normal alphabet, we are able to decrypt the message the hacker left!

THEPASMSWORDSSTOREDINYOURDATABASEWEREINPLAINTEXTANDCOMPLETELYVULNERABLEASSUCHIREPLACEDALMLTHESTOREDPASMSWORDSWITHTHEIRCORRESPONDINGROLMLINGHASHESUSINGONEOFTHEPRIMESASMSEVENTEMENANDTHEOTHERASONEEXPNINEPLUSMSEVENYOUSHOULDBEABLETOACCESMSTHEWEBSITEIFYOUCANGENERATETHECORMRESPONDINGHAOZ

The message says that the passwords stored in the data base, which were initally in plaintext, have been hashed using a rolling hash. It also gives us two prime numbers, "seventeen" and "1 EXP nine plus seven". The rolling hash does infact use two prime numbers, and one of the standard large prime numbers used is 10^9 + 7 ! This confirms that we have to use the standard rolling hash. 

After hashing the password "I AM THE BEST DOGE" using the rolling hash, we get the hash to be : 743936302

Using the rolling hash as the password, we are able to succesfully login to a page which promts us to make a writeup :)



